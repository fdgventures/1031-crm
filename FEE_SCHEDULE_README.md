# Fee Schedule System - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ Fee Schedule –ø–æ–∑–≤–æ–ª—è–µ—Ç QI (Qualified Intermediary) —Å–æ–∑–¥–∞–≤–∞—Ç—å —à–∞–±–ª–æ–Ω—ã –∫–æ–º–∏—Å—Å–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º –Ω–æ–≤—ã–º Tax Accounts. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ü–µ–Ω—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö Tax Accounts —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è.

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 3 —Ç–∞–±–ª–∏—Ü—ã:

- **fee_templates** - –®–∞–±–ª–æ–Ω—ã –∫–æ–º–∏—Å—Å–∏–π, —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–µ QI
  - `id` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `name` - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–∏
  - `price` - –¶–µ–Ω–∞ (decimal)
  - `description` - –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–∏
  - `qi_company_id` - –°–≤—è–∑—å —Å –∫–æ–º–ø–∞–Ω–∏–µ–π QI
  - `is_active` - –ê–∫—Ç–∏–≤–µ–Ω –ª–∏ —à–∞–±–ª–æ–Ω
  
- **fee_schedules** - –≠–∫–∑–µ–º–ø–ª—è—Ä—ã –∫–æ–º–∏—Å—Å–∏–π –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö Tax Accounts
  - `id` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `tax_account_id` - –°–≤—è–∑—å —Å Tax Account
  - `fee_template_id` - –°–≤—è–∑—å —Å —à–∞–±–ª–æ–Ω–æ–º
  - `name` - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–∏
  - `price` - –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞
  - `description` - –û–ø–∏—Å–∞–Ω–∏–µ
  
- **fee_change_history** - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω
  - `id` - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `fee_schedule_id` - –°–≤—è–∑—å —Å Fee Schedule
  - `old_price` - –°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞
  - `new_price` - –ù–æ–≤–∞—è —Ü–µ–Ω–∞
  - `comment` - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ –ø—Ä–∏—á–∏–Ω–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
  - `changed_by` - –ö—Ç–æ –∏–∑–º–µ–Ω–∏–ª (user_id)
  - `changed_at` - –ö–æ–≥–¥–∞ –∏–∑–º–µ–Ω–µ–Ω–æ

### 2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **FeeScheduleManager** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞–º–∏ Fee –≤ QI –¥–∞—à–±–æ—Ä–¥–µ
- **FeeSchedule** - –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Fee –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Tax Account

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –î–ª—è QI (Qualified Intermediary)

1. **–°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ Fee**:
   - –û—Ç–∫—Ä–æ–π—Ç–µ Admin Dashboard (`/admin/dashboard`)
   - –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –¥–æ —Ä–∞–∑–¥–µ–ª–∞ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Fee —à–∞–±–ª–æ–Ω–∞–º–∏"
   - –ù–∞–∂–º–∏—Ç–µ "+ –°–æ–∑–¥–∞—Ç—å Fee —à–∞–±–ª–æ–Ω"
   - –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
     - –ù–∞–∑–≤–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "Initial Setup Fee")
     - –¶–µ–Ω–∞ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä: 500.00)
     - –û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å"

2. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤**:
   - –í —Å–ø–∏—Å–∫–µ —à–∞–±–ª–æ–Ω–æ–≤ –Ω–∞–∂–º–∏—Ç–µ "‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å"
   - –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ü–µ–Ω—É –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ
   - –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"

3. **–î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–æ–≤**:
   - –ù–∞–∂–º–∏—Ç–µ "üîí –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
   - –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –Ω–µ –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –∫ –Ω–æ–≤—ã–º Tax Accounts
   - –ú–æ–∂–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ —á–µ—Ä–µ–∑ "‚úÖ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å"

4. **–£–¥–∞–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤**:
   - –ù–∞–∂–º–∏—Ç–µ "üóëÔ∏è –£–¥–∞–ª–∏—Ç—å" –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
   - ‚ö†Ô∏è –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ Tax Account

1. **–ü—Ä–æ—Å–º–æ—Ç—Ä Fee**:
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É Tax Account
   - –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –¥–æ —Ä–∞–∑–¥–µ–ª–∞ "Fee Schedule"
   - –í—Å–µ –∫–æ–º–∏—Å—Å–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ

2. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã Fee**:
   - –ù–∞–∂–º–∏—Ç–µ "‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å —Ü–µ–Ω—É" –Ω–∞–ø—Ä–æ—Ç–∏–≤ –Ω—É–∂–Ω–æ–π Fee
   - –í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é —Ü–µ–Ω—É
   - **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** —É–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
   - –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏

3. **–ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π**:
   - –ù–∞–∂–º–∏—Ç–µ "üìú –ò—Å—Ç–æ—Ä–∏—è" –Ω–∞–ø—Ä–æ—Ç–∏–≤ –ª—é–±–æ–π Fee
   - –û—Ç–∫—Ä–æ–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π:
     - –ö—Ç–æ –∏–∑–º–µ–Ω–∏–ª —Ü–µ–Ω—É
     - –ö–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª
     - –°—Ç–∞—Ä–∞—è –∏ –Ω–æ–≤–∞—è —Ü–µ–Ω–∞
     - –ü—Ä–∏—á–∏–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
   - –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ Fee

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ Tax Account:
1. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ **–∞–∫—Ç–∏–≤–Ω—ã–µ** —à–∞–±–ª–æ–Ω—ã Fee
2. –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä—ã Fee –¥–ª—è –Ω–æ–≤–æ–≥–æ Tax Account
3. –ö–æ–ø–∏—Ä—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ü–µ–Ω—É –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑ —à–∞–±–ª–æ–Ω–æ–≤
4. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ü–µ–Ω—ã –ø–æ–∑–∂–µ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

–ß—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Supabase CLI –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏
supabase db push
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ —Ñ–∞–π–ª–∞:
```
supabase/migrations/024_create_fee_schedule_system.sql
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- **RLS (Row Level Security)** –≤–∫–ª—é—á–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
- –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å Fee
- –¢–æ–ª—å–∫–æ workspace_owner –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å Fee
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ FeeScheduleManager/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FeeScheduleManager.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îî‚îÄ‚îÄ FeeSchedule/
‚îÇ       ‚îú‚îÄ‚îÄ FeeSchedule.tsx
‚îÇ       ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ admin/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dashboard/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ page.tsx (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω FeeScheduleManager)
‚îÇ   ‚îî‚îÄ‚îÄ (pages)/
‚îÇ       ‚îî‚îÄ‚îÄ tax-accounts/
‚îÇ           ‚îú‚îÄ‚îÄ page.tsx (–¥–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è Fee)
‚îÇ           ‚îî‚îÄ‚îÄ [id]/
‚îÇ               ‚îî‚îÄ‚îÄ page.tsx (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω FeeSchedule)
‚îî‚îÄ‚îÄ supabase/
    ‚îî‚îÄ‚îÄ migrations/
        ‚îî‚îÄ‚îÄ 024_create_fee_schedule_system.sql
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –¢–∏–ø–∏—á–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã Fee:

1. **Initial Setup Fee** - $500.00
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Tax Account"

2. **Annual Maintenance Fee** - $250.00
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–ï–∂–µ–≥–æ–¥–Ω–∞—è –ø–ª–∞—Ç–∞ –∑–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"

3. **Document Processing Fee** - $75.00
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"

4. **Transaction Fee** - $50.00
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–ó–∞ –∫–∞–∂–¥—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é"

### –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∏—á–∏–Ω –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã:

- "–°–∫–∏–¥–∫–∞ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞"
- "–ü–æ–≤—ã—à–µ–Ω–∏–µ —Ü–µ–Ω—ã –≤ —Å–≤—è–∑–∏ —Å –∏–Ω—Ñ–ª—è—Ü–∏–µ–π"
- "–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞"
- "–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–≤—ã–º –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–æ–º"
- "–ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∑–∞ –∑–∞–¥–µ—Ä–∂–∫—É –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏"

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É —Å–∏—Å—Ç–µ–º—ã

